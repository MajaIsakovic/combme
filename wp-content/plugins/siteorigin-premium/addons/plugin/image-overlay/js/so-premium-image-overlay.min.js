window.SiteOriginPremium=window.SiteOriginPremium||{},SiteOriginPremium.ImageOverlay=function(i,t){var e=jQuery;this.image=i,this.options=t,this.init=function(){this.imageContainer=e(i).parent().closest(":not( a )"),this.createChildren(),this.addEventListeners(),setTimeout(this.layoutChildren.bind(this),150)},this.createChildren=function(){this.canHover=window.matchMedia("(hover:hover)").matches,this.overlayContainer=e('<div class="so-premium-image-overlay-container"></div>'),this.overlay=e('<div class="so-premium-image-overlay"></div>'),this.overlayBackground=e('<div class="so-premium-image-overlay-background"></div>'),this.overlayBackground.css({backgroundColor:t.overlay_color,opacity:t.overlay_opacity}),this.overlay.append(this.overlayBackground),this.overlayText=e('<div class="so-premium-image-overlay-text">'+this.image.title+"</div>"),e(this.image).css("pointerEvents","none");var i={margin:"0",padding:this.options.text_padding};t.hasOwnProperty("font")&&t.font&&(i.fontFamily=t.font.family,t.font.hasOwnProperty("weight")&&(i.fontWeight=t.font.weight),t.font.hasOwnProperty("url")&&e("head").append('<link rel="stylesheet" media="all" href="'+t.font.url+'"/>')),t.hasOwnProperty("text_size")&&(i.fontSize=t.text_size),t.hasOwnProperty("text_color")&&(i.color=t.text_color),i.textAlign=t.text_align,this.overlayText.css(i),this.overlay.append(this.overlayText),this.overlay.css("opacity",0),this.overlayContainer.append(this.overlay),this.overlayContainer.css({overflow:"hidden"}),this.imageContainer.append(this.overlayContainer)},this.layoutChildren=function(){var i=e(this.image),t=this.imageContainer.position();t.width=Math.min(this.imageContainer.width(),i.width()),t.height=Math.min(this.imageContainer.height(),i.height());var a={top:Math.max(0,i.position().top),left:Math.max(0,i.position().left),width:t.width,height:t.height,maxWidth:this.imageContainer.css("maxWidth"),maxHeight:this.imageContainer.css("maxHeight")};this.overlayContainer.css(a);var o={top:0,left:0,width:t.width,height:t.height,maxWidth:i.css("maxWidth"),maxHeight:i.css("maxHeight")},n=this.options.overlay_size;switch(this.options.overlay_position){case"top":o.height=t.height*n;break;case"right":o.width=t.width*n,o.left=t.width-o.width;break;case"bottom":o.height=t.height*n,o.top=t.height-o.height;break;case"left":o.width=t.width*n}this.overlay.css(o);var s=this.overlay.outerHeight(),r=this.overlayText.outerHeight(),h={};switch(this.options.text_position){case"top":h.top=0;break;case"middle":h.top=.5*(s-r);break;case"bottom":h.top=s-r}this.overlayText.css(h),this.canHover||"always"!==this.options.touch_show_trigger?this.canHover&&"always"===this.options.desktop_show_trigger?this.overlay.css("opacity",1):(this.options.overlay_animation&&"none"!==this.options.overlay_animation&&(this.animationTimeline=anime.timeline({autoplay:!1}),this.animationTimeline.add(this.getAnimationOptions(this.overlay.get(0),this.options.overlay_animation,{position:this.options.overlay_position}))),this.options.text_animation&&"none"!==this.options.text_animation&&(this.animationTimeline||(this.animationTimeline=anime.timeline({autoplay:!1})),this.animationTimeline.add(this.getAnimationOptions(this.overlayText.get(0),this.options.text_animation)))):this.overlay.css("opacity",1)},this.getAnimationOptions=function(i,t,a){var o={targets:i,changeBegin:function(){this.overlayContainer.css("overflow","hidden")}.bind(this)},n=e(i);switch(t){case"fade":o.easing="linear",o.duration=250,o.opacity=[0,1];break;case"slide":switch(o.easing="easeOutExpo",o.duration=500,n.css("opacity",1),a.hasOwnProperty("position")?a.position:"top"){case"top":o.translateY=[-n.outerHeight(),0];break;case"right":o.translateX=[n.parent().outerWidth(),0];break;case"bottom":o.translateY=[n.parent().outerHeight(),0];break;case"left":o.translateX=[-n.outerWidth(),0]}break;case"slide_left":o.easing="easeOutExpo",o.duration=500,o.opacity=[0,1],o.translateX=[20,0];break;case"slide_right":o.easing="easeOutExpo",o.duration=500,o.opacity=[0,1],o.translateX=[-20,0];break;case"slide_up":o.easing="easeOutExpo",o.duration=500,o.opacity=[0,1],o.translateY=[10,0];break;case"slide_down":o.easing="easeOutExpo",o.duration=500,o.opacity=[0,1],o.translateY=[-10,0];break;case"drop":o.easing="linear",o.duration=250,o.opacity=[0,1],o.scale=[1.1,1],o.changeBegin=function(){this.overlayContainer.css("overflow","visible")}.bind(this)}return o},this.addEventListeners=function(){this.imageContainer.is(".sow-masonry-grid-item,.sow-image-grid-image")&&this.imageContainer.closest(".sow-masonry-grid,.sow-image-grid-wrapper").on("layoutComplete",this.layoutChildren.bind(this)),e(window).on("resize",this.layoutChildren.bind(this)),this.canHover?"hover"===this.options.desktop_show_trigger&&(this.imageContainer.on("mouseenter",function(){this.showOverlay()}.bind(this)),this.imageContainer.on("mouseleave",function(){this.hideOverlay()}.bind(this))):"touch"===this.options.touch_show_trigger&&this.imageContainer.on("touchend",function(){this.toggleOverlay()}.bind(this))},this.showOverlay=function(){this.showingOverlay||(this.showingOverlay=!0,this.animationTimeline?("reverse"===this.animationTimeline.direction&&this.animationTimeline.reverse(),this.animationTimeline.began&&!this.animationTimeline.completed||this.animationTimeline.play()):this.overlay.css("opacity",1))},this.hideOverlay=function(){this.showingOverlay&&(this.showingOverlay=!1,this.animationTimeline?("normal"===this.animationTimeline.direction&&this.animationTimeline.reverse(),this.animationTimeline.completed&&(this.animationTimeline.completed=!1,this.animationTimeline.play())):this.overlay.css("opacity",0))},this.toggleOverlay=function(){if(this.animationTimeline)this.animationTimeline.began&&"normal"===this.animationTimeline.direction?this.hideOverlay():this.showOverlay();else{var i=1===this.overlay.css("opacity")?0:1;this.overlay.css("opacity",i)}},i.complete?this.init():(i.addEventListener("load",function(){this.init()}.bind(this)),i.addEventListener("error",(function(){console.log("Could not setup Image Overlay. Image loading failed.")})))},SiteOriginPremium.createImageOverlays=function(i){i(".so-widget-sow-image, .so-widget-sow-image-grid, .so-widget-sow-simple-masonry").each((function(t,e){var a=i(e);if(a.data("overlay-enabled")){var o=a.data("overlay-settings");i(e).find("img").each((function(t,e){e.title&&(e.classList.contains("jetpack-lazy-image")?i(e).on("jetpack-lazy-loaded-image",(function(i){new SiteOriginPremium.ImageOverlay(i.target,o)})):new SiteOriginPremium.ImageOverlay(e,o))}))}}))},jQuery((function(i){SiteOriginPremium.createImageOverlays(i),window.sowb&&i(window.sowb).on("setup_widgets",(function(){SiteOriginPremium.createImageOverlays(i)}))}));